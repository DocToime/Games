
let gameData = {
    "Beginner": {
        "1": [
            {"words": ["dog"], "correct": "dog", "hint": "The ___ chases the cat."},
            {"words": ["tug"], "correct": "tug", "hint": "We ___ on the rope."},
            {"words": ["fog"], "correct": "fog", "hint": "The ___ makes it hard to see."},
            {"words": ["bag"], "correct": "bag", "hint": "I carry my books in a ___."},
            {"words": ["fun"], "correct": "fun", "hint": "Playing games is a lot of ___."},
            {"words": ["mat"], "correct": "mat", "hint": "Please wipe your feet on the ___."},
            {"words": ["man"], "correct": "man", "hint": "The ___ is walking his dog."},
            {"words": ["nun"], "correct": "nun", "hint": "The ___ lives at the church."},
            {"words": ["hot"], "correct": "hot", "hint": "The soup is too ___ to eat."},
            {"words": ["bog"], "correct": "bog", "hint": "The ___ is a wet, muddy area."}
        ]},

    "Reception": {
        "1": [
            {"words": ["go"], "correct": "go", "hint": "It's your turn to ___."},
            {"words": ["up"], "correct": "up", "hint": "Please look ___ at the sky."},
            {"words": ["we"], "correct": "we", "hint": "___ are going to the park."},
            {"words": ["me"], "correct": "me", "hint": "Can you help ___ with this?"},
            {"words": ["my"], "correct": "my", "hint": "This is ___ favorite toy."},
            {"words": ["on"], "correct": "on", "hint": "The cat is sitting ___ the table."},
            {"words": ["no"], "correct": "no", "hint": "___, I don't want any."},
            {"words": ["he"], "correct": "he", "hint": "___ is playing soccer."},
            {"words": ["is"], "correct": "is", "hint": "There ___ a bird in the tree."},
            {"words": ["it"], "correct": "it", "hint": "___ is raining outside."}],
        "2": [
            {"words": ["of"], "correct": "of", "hint": "A slice ___ pizza."},
            {"words": ["at"], "correct": "at", "hint": "Look ___ the stars."},
            {"words": ["to"], "correct": "to", "hint": "We went ___ the store."},
            {"words": ["in"], "correct": "in", "hint": "The cookies are ___ the jar."},
            {"words": ["am"], "correct": "am", "hint": "I ___ happy today."},
            {"words": ["you"], "correct": "you", "hint": "Are ___ coming over?"},
            {"words": ["day"], "correct": "day", "hint": "Have a nice ___!"},
            {"words": ["was"], "correct": "was", "hint": "He ___ at the park yesterday."},
            {"words": ["are"], "correct": "are", "hint": "You ___ my best friend."},
            {"words": ["the"], "correct": "the", "hint": "___ sun is shining."}],
        "3": [
            {"words": ["dog"], "correct": "dog", "hint": "The ___ barks loudly."},
            {"words": ["big"], "correct": "big", "hint": "That is a very ___ tree."},
            {"words": ["she"], "correct": "she", "hint": "___ is reading a book."},
            {"words": ["and"], "correct": "and", "hint": "Fish ___ chips are popular in Britain."},
            {"words": ["see"], "correct": "see", "hint": "Can you ___ the bird?"},
            {"words": ["mum"], "correct": "mum", "hint": "My ___ is baking a cake."},
            {"words": ["yes"], "correct": "yes", "hint": "___, I would like some tea."},
            {"words": ["for"], "correct": "for", "hint": "This present is ___ you."},
            {"words": ["dad"], "correct": "dad", "hint": "My ___ is fixing the car."},
            {"words": ["can"], "correct": "can", "hint": "I ___ run very fast."}],
        "4": [
            {"words": ["cat"], "correct": "cat", "hint": "The ___ is sleeping on the sofa."},
            {"words": ["get"], "correct": "get", "hint": "Please ___ your coat."},
            {"words": ["all"], "correct": "all", "hint": "___ the children are playing."},
            {"words": ["come"], "correct": "come", "hint": "___ here, please."},
            {"words": ["went"], "correct": "went", "hint": "We ___ to the zoo yesterday."},
            {"words": ["look"], "correct": "look", "hint": "Have a ___ at this picture."},
            {"words": ["this"], "correct": "this", "hint": "___ is my favourite toy."},
            {"words": ["like"], "correct": "like", "hint": "I ___ ice cream."},
            {"words": ["they"], "correct": "they", "hint": "___ are going to the cinema."},
            {"words": ["away"], "correct": "away", "hint": "The bird flew ___."}],
        "5": [
            {"words": ["play"], "correct": "play", "hint": "Let's ___ hide and seek."},
            {"words": ["said"], "correct": "said", "hint": "He ___ he was tired."},
            {"words": ["going"], "correct": "going", "hint": "Are you ___ to the party?"},
            {"words": ["I"], "correct": "I", "hint": "___ am learning to read."},
            {"words": ["be"], "correct": "be", "hint": "You will ___ a great player."},
            {"words": ["So"], "correct": "So", "hint": "___, what shall we do now?"},
            {"words": ["do"], "correct": "do", "hint": "What shall we ___ today?"},
            {"words": ["oh"], "correct": "oh", "hint": "___, I forgot my bag!"},
            {"words": ["Mr"], "correct": "Mr", "hint": "___ Smith is our neighbour."},
            {"words": ["her"], "correct": "her", "hint": "The cat followed ___ home."}],
        "6": [
            {"words": ["one"], "correct": "one", "hint": "He was the ___ who won."},
            {"words": ["out"], "correct": "out", "hint": "Please go ___ and play."},
            {"words": ["Mrs"], "correct": "Mrs", "hint": "___ Jones bakes delicious cakes."},
            {"words": ["into"], "correct": "into", "hint": "She went ___ the house."},
            {"words": ["have"], "correct": "have", "hint": "Do you ___ a pencil?"},
            {"words": ["some"], "correct": "some", "hint": "Would you like ___ cake?"},
            {"words": ["when"], "correct": "when", "hint": "I wonder ___ it will rain."},
            {"words": ["were"], "correct": "were", "hint": "They ___ at the park yesterday."},
            {"words": ["there"], "correct": "there", "hint": "Look, ___ is your bus!"},
            {"words": ["their"], "correct": "their", "hint": "The kids rode ___ bikes."}],
        "7": [
            {"words": ["asked"], "correct": "asked", "hint": "She ___ for a glass of water."},
            {"words": ["could"], "correct": "could", "hint": "I thought I ___ hear a bird."},
            {"words": ["little"], "correct": "little", "hint": "The ___ kitten was lost."},
            {"words": ["called"], "correct": "called", "hint": "The dog is ___ Buddy."},
            {"words": ["people"], "correct": "people", "hint": "Many ___ like to swim."},
            {"words": ["looked"], "correct": "looked", "hint": "He ___ out the window."},
            {"words": ["abacus"], "correct": "abacus", "hint": "___ is the name of a school."}],
        "Days": [
            {"words": ["Monday"], "correct": "Monday", "hint": "___ is named after the Moon."},
            {"words": ["Tuesday"], "correct": "Tuesday", "hint": "___ is named for Tyr, the Norse god of war."},
            {"words": ["Wednesday"], "correct": "Wednesday", "hint": "___ is named after Odin, the Norse god of wisdom and war."},
            {"words": ["Thursday"], "correct": "Thursday", "hint": "___ is named for Thor, the Norse god of thunder."},
            {"words": ["Friday"], "correct": "Friday", "hint": "___ is named after Frigg, the Norse goddess of love and fertility."},
            {"words": ["Saturday"], "correct": "Saturday", "hint": "___ is named for Saturn, the Roman god of agriculture and wealth."},
            {"words": ["Sunday"], "correct": "Sunday", "hint": "___ is named after the Sun."}],
        "Months": [
            {"words": ["January"], "correct": "January", "hint": "___ is named after Janus, the Roman god of doors and gates."},
            {"words": ["February"], "correct": "February", "hint": "___ is named after Februa, an early Roman festival and cleansing ritual."},
            {"words": ["March"], "correct": "March", "hint": "___ is named for Mars, the Roman god of war."},
            {"words": ["April"], "correct": "April", "hint": "___ may be derived from the Latin word 'aperire', meaning 'to open', possibly referring to the opening or blossoming of flowers and trees."},
            {"words": ["May"], "correct": "May", "hint": "___ is named after Maia, an earth goddess of growing plants."},
            {"words": ["June"], "correct": "June", "hint": "___ is named after Juno, the Roman goddess of marriage and the well-being of women."},
            {"words": ["July"], "correct": "July", "hint": "___ was named in honour of Julius Caesar."},
            {"words": ["August"], "correct": "August", "hint": "___ was named in honour of Augustus Caesar."},
            {"words": ["September"], "correct": "September", "hint": "___, meaning 'seventh', was originally the seventh month in the ancient Roman calendar."},
            {"words": ["October"], "correct": "October", "hint": "___, meaning 'eighth', was originally the eighth month in the ancient Roman calendar."},
            {"words": ["November"], "correct": "November", "hint": "___, meaning 'ninth', was originally the ninth month in the ancient Roman calendar."},
            {"words": ["December"], "correct": "December", "hint": "___, meaning 'tenth', was originally the tenth month in the ancient Roman calendar."}],
        "Numbers 0-10": [
            {"words": ["zero"], "correct": "zero", "hint": "___ is the number that represents no quantity or size."},
            {"words": ["one"], "correct": "one", "hint": "___ is the first natural number."},
            {"words": ["two"], "correct": "two", "hint": "___ is the only even prime number."},
            {"words": ["three"], "correct": "three", "hint": "___ is often used to represent balance, as in a tripod."},
            {"words": ["four"], "correct": "four", "hint": "___ is the number of sides in a square."},
            {"words": ["five"], "correct": "five", "hint": "A starfish typically has ___ arms."},
            {"words": ["six"], "correct": "six", "hint": "A standard die has ___ faces."},
            {"words": ["seven"], "correct": "seven", "hint": "There are ___ days in a week."},
            {"words": ["eight"], "correct": "eight", "hint": "An octopus has ___ tentacles."},
            {"words": ["nine"], "correct": "nine", "hint": "A cat is said to have ___ lives."},
            {"words": ["ten"], "correct": "ten", "hint": "There are ___ fingers on two hands."}],
        "Numbers 11-20": [
            {"words": ["eleven"], "correct": "eleven", "hint": "___ is the first number after ten."},
            {"words": ["twelve"], "correct": "twelve", "hint": "A dozen is made up of ___ items."},
            {"words": ["thirteen"], "correct": "thirteen", "hint": "___ is considered an unlucky number in some cultures."},
            {"words": ["fourteen"], "correct": "fourteen", "hint": "Valentine's Day falls on February ___."},
            {"words": ["fifteen"], "correct": "fifteen", "hint": "In tennis, the first point won is ___."},
            {"words": ["sixteen"], "correct": "sixteen", "hint": "A sweet ___ party is a coming-of-age celebration."},
            {"words": ["seventeen"], "correct": "seventeen", "hint": "___ is the age at which you can learn to drive in the UK."},
            {"words": ["eighteen"], "correct": "eighteen", "hint": "When you turn ___, you are considered an adult in many countries."},
            {"words": ["nineteen"], "correct": "nineteen", "hint": "___ is the last of the 'teen' numbers."},
            {"words": ["twenty"], "correct": "twenty", "hint": "A score is ___ years."}],
        "colours": [
            {"words": ["red"], "correct": "red", "hint": "Apples can be ___. It's a very bright colour."},
            {"words": ["blue"], "correct": "blue", "hint": "The sky is often ___. It's a cool colour."},
            {"words": ["yellow"], "correct": "yellow", "hint": "Lemons are ___. It's a very bright colour."},
            {"words": ["green"], "correct": "green", "hint": "Grass is ___. Leaves are often this colour too."},
            {"words": ["orange"], "correct": "orange", "hint": "Carrots are ___. It's like a mix of red and yellow."},
            {"words": ["purple"], "correct": "purple", "hint": "Grapes can be ___. It's a dark colour."},
            {"words": ["pink"], "correct": "pink", "hint": "Bubblegum is often ___. It's a light red."},
            {"words": ["brown"], "correct": "brown", "hint": "Chocolate is ___. Many trees are this colour."},
            {"words": ["black"], "correct": "black", "hint": "The night is ___. Ravens are this colour too."},
            {"words": ["white"], "correct": "white", "hint": "Snow is ___. It's the brightest colour."}]
                              
        },
    "Year1": {
        "1": [
            {"words": ["an"], "correct": "an", "hint": "I saw ___ apple on the table."},
            {"words": ["do"], "correct": "do", "hint": "What shall we ___ now?"},
            {"words": ["be"], "correct": "be", "hint": "Please ___ quiet in the library."},
            {"words": ["by"], "correct": "by", "hint": "The cat sat ___ the fire."},
            {"words": ["as"], "correct": "as", "hint": "Quiet ___ a mouse."},
            {"words": ["if"], "correct": "if", "hint": "I'll go out ___ it stops raining."},
            {"words": ["or"], "correct": "or", "hint": "Would you like tea ___ coffee?"},
            {"words": ["so"], "correct": "so", "hint": "He was hungry, ___ he ate a sandwich."},
            {"words": ["us"], "correct": "us", "hint": "Mum will take ___ to the park."},
            {"words": ["her"], "correct": "her", "hint": "I gave the book to ___."}],
        "2": [
            {"words": ["who"], "correct": "who", "hint": "___ is knocking at the door?"},
            {"words": ["may"], "correct": "may", "hint": "You ___ have a biscuit."},
            {"words": ["did"], "correct": "did", "hint": "___ you see the cat?"},
            {"words": ["him"], "correct": "him", "hint": "She passed the ball to ___."},
            {"words": ["his"], "correct": "his", "hint": "That is ___ bicycle."},
            {"words": ["put"], "correct": "put", "hint": "Please ___ your toys away."},
            {"words": ["you"], "correct": "you", "hint": "Did ___ finish your homework?"},
            {"words": ["ran"], "correct": "ran", "hint": "He ___ around the park."},
            {"words": ["how"], "correct": "how", "hint": "___ are you today?"},
            {"words": ["new"], "correct": "new", "hint": "She has a ___ dress."}],
        "3": [
            {"words": ["saw"], "correct": "saw", "hint": "I ___ a bird in the tree."},
            {"words": ["two"], "correct": "two", "hint": "There are ___ apples on the table."},
            {"words": ["not"], "correct": "not", "hint": "I am ___ going to bed yet."},
            {"words": ["bed"], "correct": "bed", "hint": "It's time to go to ___."},
            {"words": ["now"], "correct": "now", "hint": "We will leave ___."},
            {"words": ["off"], "correct": "off", "hint": "The cat jumped ___ the wall."},
            {"words": ["boy"], "correct": "boy", "hint": "The young ___ played football."},
            {"words": ["old"], "correct": "old", "hint": "My grandad is very ___."},
            {"words": ["had"], "correct": "had", "hint": "She ___ a great time at the party."},
            {"words": ["way"], "correct": "way", "hint": "Which ___ did they go?"}],
        "4": [
            {"words": ["but"], "correct": "but", "hint": "I like cats, ___ I love dogs more."},
            {"words": ["one"], "correct": "one", "hint": "He is the ___ who won the race."},
            {"words": ["has"], "correct": "has", "hint": "She ___ a new book."},
            {"words": ["our"], "correct": "our", "hint": "This is ___ house."},
            {"words": ["man"], "correct": "man", "hint": "The ___ is walking his dog."},
            {"words": ["out"], "correct": "out", "hint": "Let's go ___ for a walk."},
            {"words": ["got"], "correct": "got", "hint": "He ___ a new bike for his birthday."},
            {"words": ["too"], "correct": "too", "hint": "It's ___ hot outside."},
            {"words": ["many"], "correct": "many", "hint": "There are ___ sweets in the jar."},
            {"words": ["over"], "correct": "over", "hint": "The ball went ___ the fence."}],
        "5": [
            {"words": ["then"], "correct": "then", "hint": "First we eat, ___ we play."},
            {"words": ["here"], "correct": "here", "hint": "Come ___ and see this."},
            {"words": ["will"], "correct": "will", "hint": "I ___ be back soon."},
            {"words": ["more"], "correct": "more", "hint": "Can I have some ___ cake, please?"},
            {"words": ["push"], "correct": "push", "hint": "Please ___ the door to open it."},
            {"words": ["with"], "correct": "with", "hint": "She played ___ her toys."},
            {"words": ["much"], "correct": "much", "hint": "How ___ is that toy?"},
            {"words": ["pull"], "correct": "pull", "hint": "___ the rope to ring the bell."},
            {"words": ["home"], "correct": "home", "hint": "We're going ___ now."},
            {"words": ["must"], "correct": "must", "hint": "You ___ be quiet in the library."}],
        "6": [
            {"words": ["time"], "correct": "time", "hint": "What ___ is it?"},
            {"words": ["your"], "correct": "your", "hint": "Is this ___ pencil?"},
            {"words": ["name"], "correct": "name", "hint": "What is ___ of your school?"},
            {"words": ["back"], "correct": "back", "hint": "He looked ___ to wave goodbye."},
            {"words": ["door"], "correct": "door", "hint": "Please close the ___."},
            {"words": ["took"], "correct": "took", "hint": "She ___ her book to school."},
            {"words": ["ball"], "correct": "ball", "hint": "He kicked the ___ into the goal."},
            {"words": ["down"], "correct": "down", "hint": "The cat climbed ___ from the tree."},
            {"words": ["next"], "correct": "next", "hint": "Who is ___ in line?"},
            {"words": ["tree"], "correct": "tree", "hint": "The bird is in the ___."}],
        "7": [
            {"words": ["jump"], "correct": "jump", "hint": "Can you ___ over the puddle?"},
            {"words": ["seen"], "correct": "seen", "hint": "Have you ever ___ a lion?"},
            {"words": ["from"], "correct": "from", "hint": "This letter is ___ my friend."},
            {"words": ["just"], "correct": "just", "hint": "I've ___ finished my homework."},
            {"words": ["girl"], "correct": "girl", "hint": "The ___ is playing with her doll."},
            {"words": ["last"], "correct": "last", "hint": "She was the ___ to leave."},
            {"words": ["very"], "correct": "very", "hint": "This cake is ___ tasty."},
            {"words": ["been"], "correct": "been", "hint": "I have ___ to London."},
            {"words": ["good"], "correct": "good", "hint": "She is a ___ swimmer."},
            {"words": ["want"], "correct": "want", "hint": "Do you ___ to play a game?"}],
        "8": [
            {"words": ["some"], "correct": "some", "hint": "Would you like ___ juice?"},
            {"words": ["live"], "correct": "live", "hint": "They ___ in a big house."},
            {"words": ["once"], "correct": "once", "hint": "___ upon a time, there was a king."},
            {"words": ["take"], "correct": "take", "hint": "Can you ___ this to your mum?"},
            {"words": ["half"], "correct": "half", "hint": "I ate ___ of the pizza."},
            {"words": ["love"], "correct": "love", "hint": "I ___ going to the park."},
            {"words": ["than"], "correct": "than", "hint": "He is faster ___ his brother."},
            {"words": ["were"], "correct": "were", "hint": "They ___ happy to see me."},
            {"words": ["made"], "correct": "made", "hint": "She ___ a beautiful painting."},
            {"words": ["that"], "correct": "that", "hint": "Do you see ___ bird?"}],
        "9": [
            {"words": ["what"], "correct": "what", "hint": "___ is your favourite colour?"},
            {"words": ["call"], "correct": "call", "hint": "I will ___ my friend tonight."},
            {"words": ["have"], "correct": "have", "hint": "Do you ___ a pet?"},
            {"words": ["make"], "correct": "make", "hint": "Can you ___ a cake?"},
            {"words": ["when"], "correct": "when", "hint": "___ is your birthday?"},
            {"words": ["came"], "correct": "came", "hint": "He ___ to my house yesterday."},
            {"words": ["help"], "correct": "help", "hint": "Can you ___ me with this puzzle?"},
            {"words": ["them"], "correct": "them", "hint": "Give the books to ___."},
            {"words": ["about"], "correct": "about", "hint": "What is this story ___?"},
            {"words": ["can't"], "correct": "can't", "hint": "I ___ find my socks."}],
        "10": [
            {"words": ["after"], "correct": "after", "hint": "We will play ___ lunch."},
            {"words": ["could"], "correct": "could", "hint": "I thought I ___ hear a bird."},
            {"words": ["there"], "correct": "there", "hint": "Look, ___ is a rainbow!"},
            {"words": ["again"], "correct": "again", "hint": "Let's read the story ___."},
            {"words": ["these"], "correct": "these", "hint": "___ are my favourite biscuits."},
            {"words": ["three"], "correct": "three", "hint": "She has ___ red balloons."},
            {"words": ["would"], "correct": "would", "hint": "___ you like some cake?"},
            {"words": ["don't"], "correct": "don't", "hint": "I ___ know the answer."},
            {"words": ["house"], "correct": "house", "hint": "They live in a big ___."},
            {"words": ["first"], "correct": "first", "hint": "He was the ___ to arrive."}],
        "11": [
            {"words": ["night"], "correct": "night", "hint": "The stars come out at ___."},
            {"words": ["laugh"], "correct": "laugh", "hint": "They all had a ___ together."},
            {"words": ["water"], "correct": "water", "hint": "Please may I have a glass of ___?"},
            {"words": ["lived"], "correct": "lived", "hint": "She ___ in a small village."},
            {"words": ["their"], "correct": "their", "hint": "The children played in ___ garden."},
            {"words": ["where"], "correct": "where", "hint": "___ did you put my book?"},
            {"words": ["people"], "correct": "people", "hint": "Many ___ visit the museum."},
            {"words": ["school"], "correct": "school", "hint": "I go to ___ every day."},
            {"words": ["should"], "correct": "should", "hint": "You ___ wear a coat."},
            {"words": ["sister"], "correct": "sister", "hint": "His ___ is my friend."}],
        "12": [
            {"words": ["little"], "correct": "little", "hint": "She has a ___ kitten."},
            {"words": ["called"], "correct": "called", "hint": "The dog is ___ Max."},
            {"words": ["another"], "correct": "another", "hint": "Can I have ___ biscuit, please?"},
            {"words": ["because"], "correct": "because", "hint": "I'm happy ___ it's sunny."},
            {"words": ["brother"], "correct": "brother", "hint": "My ___ is older than me."},
            {"words": ["today"], "correct": "today", "hint": "We are going to the park ___."},
            {"words": ["says"], "correct": "says", "hint": "The teacher ___ it's time for class."},
            {"words": ["ask"], "correct": "ask", "hint": "Can you ___ your mum for help?"},
            {"words": ["full"], "correct": "full", "hint": "My glass is ___ of water."},
            {"words": ["friend"], "correct": "friend", "hint": "I like playing with my ___ at school."}]

            // ... Additional levels can be added in the same structure ...
        },
    "Year2": {
        "1": [
            {"words": ["floor"], "correct": "floor", "hint": "Please pick up the toys from the ___."},
            {"words": ["poor"], "correct": "poor", "hint": "The ___ cat was hungry."},
            {"words": ["find"], "correct": "find", "hint": "Can you ___ your shoes?"},
            {"words": ["kind"], "correct": "kind", "hint": "It is nice to be ___ to others."},
            {"words": ["mind"], "correct": "mind", "hint": "Please ___ your manners."},
            {"words": ["behind"], "correct": "behind", "hint": "The dog hid ___ the sofa."},
            {"words": ["child"], "correct": "child", "hint": "Every ___ likes to play."},
            {"words": ["children"], "correct": "children", "hint": "The ___ are playing in the park."},
            {"words": ["wild"], "correct": "wild", "hint": "Lions are ___ animals."},
            {"words": ["climb"], "correct": "climb", "hint": "Monkeys like to ___ trees."}],
        "2": [
            {"words": ["most"], "correct": "most", "hint": "She ate the ___ cake."},
            {"words": ["only"], "correct": "only", "hint": "He was the ___ one who knew the answer."},
            {"words": ["both"], "correct": "both", "hint": "___ of the cats are sleeping."},
            {"words": ["cold"], "correct": "cold", "hint": "In winter, it is very ___ outside."},
            {"words": ["gold"], "correct": "gold", "hint": "Pirates search for ___ treasure."},
            {"words": ["hold"], "correct": "hold", "hint": "Can you ___ my hand?"},
            {"words": ["told"], "correct": "told", "hint": "She ___ a funny joke."},
            {"words": ["every"], "correct": "every", "hint": "___ morning, we have breakfast."},
            {"words": ["everybody"], "correct": "everybody", "hint": "___ in the class was happy."},
            {"words": ["even"], "correct": "even", "hint": "___ numbers end with 0, 2, 4, 6, or 8."}],
        "3": [
            {"words": ["great"], "correct": "great", "hint": "She did a ___ job on her project."},
            {"words": ["break"], "correct": "break", "hint": "Please don't ___ the toy."},
            {"words": ["steak"], "correct": "steak", "hint": "For dinner, they had ___ and vegetables."},
            {"words": ["pretty"], "correct": "pretty", "hint": "The flowers are very ___. It's a word for 'nice looking'."},
            {"words": ["beautiful"], "correct": "beautiful", "hint": "The sunset is ___. It's a word for 'very pretty'."},
            {"words": ["fast"], "correct": "fast", "hint": "Cheetahs can run very ___. It's the opposite of slow."},
            {"words": ["past"], "correct": "past", "hint": "She walked ___ the shops. It's a word for 'by' or 'beyond'."},
            {"words": ["father"], "correct": "father", "hint": "My ___ is very tall. It's another word for 'dad'."},
            {"words": ["class"], "correct": "class", "hint": "We learn new things in ___. It's a room at school."},
            {"words": ["grass"], "correct": "grass", "hint": "The ___ is green in the park. It's a type of plant."}],
        "4": [
            {"words": ["pass"], "correct": "pass", "hint": "Could you ___ me the salt? It's a word for 'give'."},
            {"words": ["plant"], "correct": "plant", "hint": "A ___ needs water to grow. It's a living thing in the ground."},
            {"words": ["path"], "correct": "path", "hint": "We walked down the ___ in the woods. It's a trail or way."},
            {"words": ["bath"], "correct": "bath", "hint": "I take a ___ before bed. It's a tub for washing."},
            {"words": ["hour"], "correct": "hour", "hint": "There are 60 minutes in an ___. It's a unit of time."},
            {"words": ["move"], "correct": "move", "hint": "Please ___ your chair closer. It means 'change position'."},
            {"words": ["prove"], "correct": "prove", "hint": "Can you ___ you did your homework? It means 'show it is true'."},
            {"words": ["improve"], "correct": "improve", "hint": "She wants to ___ her reading. It means 'make better'."},
            {"words": ["sure"], "correct": "sure", "hint": "Are you ___ you locked the door? It means 'certain'."},
            {"words": ["sugar"], "correct": "sugar", "hint": "Please add some ___ to my tea. It's sweet and white."}],
        "5": [
            {"words": ["eye"], "correct": "eye", "hint": "We see with our ___. It's a part of the face."},
            {"words": ["whole"], "correct": "whole", "hint": "He ate the ___ cake. It means 'all of it'."},
            {"words": ["any"], "correct": "any", "hint": "Do you have ___ questions? It means 'even one'."},
            {"words": ["clothes"], "correct": "clothes", "hint": "She puts on her ___ in the morning. They are what we wear."},
            {"words": ["busy"], "correct": "busy", "hint": "The shop is very ___. It means 'a lot to do'."},
            {"words": ["money"], "correct": "money", "hint": "We use ___ to buy things. It's coins and notes."},
            {"words": ["parents"], "correct": "parents", "hint": "My ___ help me with homework. They are mum and dad."}]
        },
    "Year3_4": {
        "1": [
            {"words": ["accident"], "correct": "accident", "hint": "She fell by ___ while running. It means 'something unplanned'."},
            {"words": ["centre"], "correct": "centre", "hint": "The table is in the ___ of the room. It means 'middle'."},
            {"words": ["accidentally"], "correct": "accidentally", "hint": "He ___ broke the glass. It means 'by mistake'."},
            {"words": ["century"], "correct": "century", "hint": "A ___ is 100 years. It's a long time period."},
            {"words": ["experience"], "correct": "experience", "hint": "Traveling gives you new ___. It's what you know or feel."},
            {"words": ["important"], "correct": "important", "hint": "Homework is ___. It means 'having great value'."},
            {"words": ["ordinary"], "correct": "ordinary", "hint": "It was an ___ day. Nothing special happened."},
            {"words": ["reign"], "correct": "reign", "hint": "The queen's ___ was long. It means 'to rule'."},
            {"words": ["experiment"], "correct": "experiment", "hint": "We did a science ___. It's a test to learn something new."},
            {"words": ["interest"], "correct": "interest", "hint": "He has an ___ in football. It's what you like to do or know about."}],
        "2": [
            {"words": ["particular"], "correct": "particular", "hint": "She is very ___ about her food. It means 'specific' or 'special'."},
            {"words": ["remember"], "correct": "remember", "hint": "Don't forget to ___ your bag. It means 'keep in mind'."},
            {"words": ["actual"], "correct": "actual", "hint": "The ___ story was different. It means 'real' or 'true'."},
            {"words": ["certain"], "correct": "certain", "hint": "I am ___ it will rain. It means 'sure'."},
            {"words": ["extreme"], "correct": "extreme", "hint": "Skydiving is an ___ sport. It means 'very great' or 'serious'."},
            {"words": ["island"], "correct": "island", "hint": "Hawaii is an ___. It's land surrounded by water."},
            {"words": ["peculiar"], "correct": "peculiar", "hint": "The cat's behavior was ___. It means 'strange'."},
            {"words": ["sentence"], "correct": "sentence", "hint": "A ___ ends with a full stop. It's a group of words."},
            {"words": ["actually"], "correct": "actually", "hint": "I ___ like broccoli. It means 'in fact'."},
            {"words": ["circle"], "correct": "circle", "hint": "Draw a ___. It's a round shape."}],
        "3": [
            {"words": ["famous"], "correct": "famous", "hint": "Many people know about ___ people. It means 'well-known'."},
            {"words": ["knowledge"], "correct": "knowledge", "hint": "Reading books increases your ___. It's what you know."},
            {"words": ["perhaps"], "correct": "perhaps", "hint": "___ we will go out later. It means 'maybe'."},
            {"words": ["separate"], "correct": "separate", "hint": "Keep the colours ___. It means 'not together'."},
            {"words": ["address"], "correct": "address", "hint": "Write your ___ on the envelope. It's where you live."},
            {"words": ["complete"], "correct": "complete", "hint": "She needs to ___ her homework. It means 'finish'."},
            {"words": ["favourite"], "correct": "favourite", "hint": "Ice cream is my ___. It's what you like the most."},
            {"words": ["learn"], "correct": "learn", "hint": "We ___ new things at school. It means 'gain knowledge'."},
            {"words": ["popular"], "correct": "popular", "hint": "This game is very ___. Many people like it."},
            {"words": ["special"], "correct": "special", "hint": "Her birthday is a ___ day. It means 'different from normal'."}],
        "4": [
            {"words": ["although"], "correct": "although", "hint": "___ it's raining, we will go out. It means 'despite this'."},
            {"words": ["consider"], "correct": "consider", "hint": "Please ___ all options. It means 'think about'."},
            {"words": ["length"], "correct": "length", "hint": "Measure the ___ of the table. It's how long something is."},
            {"words": ["position"], "correct": "position", "hint": "What is your ___ in the race? It's where you are."},
            {"words": ["straight"], "correct": "straight", "hint": "Draw a ___ line. It's not curved or bent."},
            {"words": ["answer"], "correct": "answer", "hint": "Please give me the ___ to the question. It's the solution."},
            {"words": ["continue"], "correct": "continue", "hint": "The show must ___. It means 'go on'."},
            {"words": ["forwards"], "correct": "forwards", "hint": "He walked ___. It's the opposite of backwards."},
            {"words": ["library"], "correct": "library", "hint": "You can borrow books from the ___. It's a place with many books."},
            {"words": ["possess"], "correct": "possess", "hint": "She does not ___ a car. It means 'have'."}],
        "5": [
            {"words": ["strange"], "correct": "strange", "hint": "The noise was ___. It means 'unusual'."},
            {"words": ["appear"], "correct": "appear", "hint": "The sun will ___ in the morning. It means 'come into view'."},
            {"words": ["decide"], "correct": "decide", "hint": "You must ___ which one to choose. It means 'make a choice'."},
            {"words": ["fruit"], "correct": "fruit", "hint": "Apples are a type of ___. It's something healthy to eat."},
            {"words": ["material"], "correct": "material", "hint": "Cotton is a type of ___. It's what things are made from."},
            {"words": ["possession"], "correct": "possession", "hint": "His bike is his prized ___. It means 'something owned'."},
            {"words": ["strength"], "correct": "strength", "hint": "Lifting weights builds ___. It means 'power' or 'force'."},
            {"words": ["arrive"], "correct": "arrive", "hint": "The train will ___ soon. It means 'come to a place'."},
            {"words": ["describe"], "correct": "describe", "hint": "Can you ___ your pet? It means 'tell about'."},
            {"words": ["grammar"], "correct": "grammar", "hint": "We learn about ___ in English class. It's about language rules."}],
        "6": [
            {"words": ["medicine"], "correct": "medicine", "hint": "She takes ___ when she's ill. It's used to treat sickness."},
            {"words": ["possible"], "correct": "possible", "hint": "Is it ___ to finish this today? It means 'can be done'."},
            {"words": ["suppose"], "correct": "suppose", "hint": "I ___ you're right. It means 'think' or 'assume'."},
            {"words": ["sugar"], "correct": "sugar", "hint": "Tea tastes sweet with ___. It's a type of sweetener."},
            {"words": ["therefore"], "correct": "therefore", "hint": "It rained, ___ we stayed inside. It means 'as a result'."},
            {"words": ["breathe"], "correct": "breathe", "hint": "We ___ in air to live. It's taking air into your lungs."},
            {"words": ["early"], "correct": "early", "hint": "She wakes up ___ in the morning. It's before the usual time."},
            {"words": ["heard"], "correct": "heard", "hint": "I ___ a loud noise. It means 'listened to'."},
            {"words": ["naughty"], "correct": "naughty", "hint": "The child was being ___. It means 'badly behaved'."},
            {"words": ["promise"], "correct": "promise", "hint": "I ___ to help you. It's a vow or commitment."}],
        "7": [
            {"words": ["build"], "correct": "build", "hint": "They will ___ a new house. It means 'construct'."},
            {"words": ["earth"], "correct": "earth", "hint": "Plants grow in the ___. It's the ground or soil."},
            {"words": ["heart"], "correct": "heart", "hint": "The ___ pumps blood. It's an organ in your body."},
            {"words": ["notice"], "correct": "notice", "hint": "Did you ___ the new sign? It means 'observe'."},
            {"words": ["purpose"], "correct": "purpose", "hint": "The ___ of school is to learn. It means 'reason'."},
            {"words": ["through"], "correct": "through", "hint": "The path goes ___ the forest. It means 'from end to end'."},
            {"words": ["busy"], "correct": "busy", "hint": "She's ___ with homework. It means 'occupied'."},
            {"words": ["height"], "correct": "height", "hint": "What is your ___? It means 'how tall'."},
            {"words": ["occasion"], "correct": "occasion", "hint": "A birthday is a special ___. It's an event."},
            {"words": ["quarter"], "correct": "quarter", "hint": "A ___ is one-fourth of something."}],
        "8": [
            {"words": ["various"], "correct": "various", "hint": "There are ___ types of fruit. It means 'different kinds'."},
            {"words": ["weight"], "correct": "weight", "hint": "The ___ of the bag is heavy. It's how heavy something is."},
            {"words": ["calendar"], "correct": "calendar", "hint": "Mark the date on the ___. It's used to show dates."},
            {"words": ["enough"], "correct": "enough", "hint": "We have ___ food for everyone. It means 'sufficient'."},
            {"words": ["imagine"], "correct": "imagine", "hint": "Can you ___ a world of peace? It means 'visualize'."},
            {"words": ["often"], "correct": "often", "hint": "She ___ goes for a walk. It means 'frequently'."},
            {"words": ["recent"], "correct": "recent", "hint": "The ___ news is important. It means 'not long ago'."},
            {"words": ["woman"], "correct": "woman", "hint": "A grown-up girl is a ___. It's an adult female person."},
            {"words": ["caught"], "correct": "caught", "hint": "The cat ___ the mouse. It means 'captured'."},
            {"words": ["exercise"], "correct": "exercise", "hint": "Running is good ___. It's physical activity."}],
        "9": [
            {"words": ["increase"], "correct": "increase", "hint": "Prices tend to ___ every year. It means 'go up'."},
            {"words": ["opposite"], "correct": "opposite", "hint": "Hot is the ___ of cold. It means 'completely different'."},
            {"words": ["regular"], "correct": "regular", "hint": "He visits the park on a ___ basis. It means 'usual'."},
            {"words": ["women"], "correct": "women", "hint": "Many ___ work in the office. It's plural of 'woman'."},
            ],
        
        // ... Continue for the remaining words ...
    }
        
    };

const introAudios = [
    "the word I'd like you to spell is",
    "the next word is",
    "this is a tricky one. please spell",
    "please could you spell",
    "now spell"
];

let currentDifficulty = "Beginner"; // Default difficulty
let currentLevel = "1"; // Default level
let currentQuestionIndex = 0;
let score = 0;
let mistakes = 0;
let hintUsed = false;
const modeSelect = document.getElementById('mode-select');
let currentMode = modeSelect.value; // Initialize with the current value of modeSelect

const gameContainer = document.getElementById('game-container');


function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function createWordButtons(words) {
    const wordOptionsContainer = document.getElementById('word-options');
    wordOptionsContainer.innerHTML = '';
    hintUsed = false;
    const playAudioButton = document.getElementById('play-audio');
    playAudioButton.style.display = 'none';

    // Creating only one button and hiding it
    const word = words[0]; // Assuming the first word is the one to guess
    const button = document.createElement('button');
    button.innerText = word;
    button.style.display = 'none'; // Hide the button initially
    button.addEventListener('click', () => handleWordSelection(word));
    wordOptionsContainer.appendChild(button);
    playWordAudio();
    displayHint();

    document.getElementById('play-audio').style.display = 'block';
}


function updateDisplay(message) {
    const messageElement = document.getElementById('message');
    messageElement.innerHTML = message || '&nbsp;';
    document.getElementById('score').innerText = 'Score: ' + score;
    document.getElementById('mistakes').innerText = 'Mistakes: ' + mistakes;

    // Ensure the hint remains visible
    displayHint();
}

function clearMessage() {
    const messageElement = document.getElementById('message');
    if (messageElement.innerHTML.startsWith('Oops')) {
        messageElement.innerHTML = '&nbsp;';
    }
}


function handleWordSelection(selectedWord) {
    const currentQuestion = gameData[currentDifficulty][currentLevel][currentQuestionIndex];

    if (selectedWord === currentQuestion.correct) {
        gameContainer.classList.add('flash-green');
        setTimeout(() => gameContainer.classList.remove('flash-green'), 500);
        score++;
        updateDisplay('Correct!');
        setTimeout(clearMessage, 5000);
        currentQuestionIndex++;

        if (currentQuestionIndex >= gameData[currentDifficulty][currentLevel].length) {
            updateDisplay('Round ' + currentLevel + ' complete! Moving to next level...');
            finishLevel();
        } else {
            setTimeout(() => {
                createWordButtons(gameData[currentDifficulty][currentLevel][currentQuestionIndex].words);
                updateSpelledWordPlaceholder();
            currentMode = modeSelect.value; // Update the current mode

            createKeyboard(currentMode); // Recreate the keyboard for the new question
            }, 500);
        }
    } else {
        gameContainer.classList.add('flash-red');
        setTimeout(() => gameContainer.classList.remove('flash-red'), 500);
        mistakes++;
        updateDisplay('This is a tough one! Try again, or use the Hint button.');
        // Google Analytics Event for a Mistake
        gtag('event', 'make_mistake', {
            'event_category': 'Game Actions',
            'event_label': `Mistake Made - Difficulty: ${currentDifficulty}, Level: ${currentLevel}, Question: ${currentQuestionIndex}`
        });
    }
}

function startLevel(difficulty, level) {
    currentDifficulty = difficulty;
    currentLevel = String(level); // Ensure level is a string
    currentQuestionIndex = 0;
    score = 0;
    mistakes = 0;

    // Update the difficulty and level dropdowns to reflect the new difficulty and level
    const difficultySelect = document.getElementById('difficulty-selector');
    const levelSelect = document.getElementById('level-select');
    difficultySelect.value = currentDifficulty;
    levelSelect.value = currentLevel;

    // Additional logic to handle invalid difficulty or level
    if (!gameData[currentDifficulty] || !gameData[currentDifficulty][currentLevel]) {
        console.error('Invalid difficulty or level');
        return;
    }

    clearKeyboard();
    createWordButtons(gameData[currentDifficulty][currentLevel][currentQuestionIndex].words);
    setupGameContainer(); // Set up the game container for the spelling display
    createKeyboard(currentMode); // Create the keyboard for spelling input
    updateDisplay('');
    document.getElementById('start-button').style.display = 'none';
    document.getElementById('instructions-button').style.display = 'none';

    // Show the hint button etc when the game starts
    document.getElementById('hint-button').style.display = 'block';
    document.getElementById('score-container').style.display = 'block';
    document.getElementById('mistakes').style.display = 'block';

    // Automatically play audio
    displayHint();


    gtag('event', 'start_game', {
        'event_category': 'Game Actions',
        'event_label': `Game Started - Difficulty: ${difficulty}, Level: ${level}`
    });
}

function clearKeyboard() {
    // Remove existing keyboard if it exists
    const existingKeyboard = document.getElementById('keyboard-container');
    if (existingKeyboard) {
        gameContainer.removeChild(existingKeyboard);
    }

    // Clear the spelled word placeholder
    const spelledWordElement = document.getElementById('spelled-word');
    if (spelledWordElement) {
        spelledWordElement.textContent = '';
    }
}

document.addEventListener('DOMContentLoaded', () => {
    // Populate difficulties and levels
    populateDifficulties();
    populateLevels(currentDifficulty);

    // Set up event listeners for dropdowns and buttons
    const difficultySelect = document.getElementById('difficulty-selector');
    const levelSelect = document.getElementById('level-select');

    difficultySelect.addEventListener('change', () => {
        populateLevels(difficultySelect.value); // Populate levels based on the selected difficulty
        showStartNewGameButton();
    });

    levelSelect.addEventListener('change', showStartNewGameButton);

    function showStartNewGameButton() {
        document.getElementById('start-new-game').style.display = 'block';
    }

    document.getElementById('start-new-game').addEventListener('click', () => {
        const selectedDifficulty = difficultySelect.value;
        const selectedLevel = levelSelect.value;
        startLevel(selectedDifficulty, selectedLevel);
        document.getElementById('start-new-game').style.display = 'none'; // Hide the button after starting the game
    });
    document.getElementById('start-button').addEventListener('click', () => {
        const selectedDifficulty = difficultySelect.value;
        const selectedLevel = levelSelect.value;
        startLevel(selectedDifficulty, selectedLevel);
    });

    document.getElementById('hint-button').addEventListener('click', function() {
        const correctWord = gameData[currentDifficulty][currentLevel][currentQuestionIndex].correct;
        flashWord(correctWord);
    });

    // Font selector logic
    var fontSelector = document.getElementById('font-selector');
    if (fontSelector) {
        fontSelector.addEventListener('change', function() {
            var selectedFont = this.value;
            document.body.style.fontFamily = selectedFont;
            var wordButtons = document.querySelectorAll('#word-options button');
            wordButtons.forEach(function(button) {
                button.style.fontFamily = selectedFont;
            });
        });
    }

    const modeSelect = document.getElementById('mode-select');
    modeSelect.addEventListener('change', () => {
        const selectedMode = modeSelect.value;
        createKeyboard(selectedMode); // Update the keyboard based on the selected mode
    });
});



function populateLevels(difficulty) {
    const levelSelect = document.getElementById('level-select');
    levelSelect.innerHTML = '';

    const levels = gameData[difficulty];
    Object.keys(levels).forEach(level => {
        const option = document.createElement('option');
        option.value = level;
        option.textContent = level;
        levelSelect.appendChild(option);
    });

    levelSelect.value = "1"; // Default to Level 1 as a string
}

function displayHint() {
    // Check if the current question exists
    if (gameData[currentDifficulty] && gameData[currentDifficulty][currentLevel] && gameData[currentDifficulty][currentLevel][currentQuestionIndex]) {
        const hint = gameData[currentDifficulty][currentLevel][currentQuestionIndex].hint;
        const hintElement = document.getElementById('hint');
        hintElement.innerText = hint;
        hintElement.style.visibility = 'visible';
    } else {
        // If no current question, clear the hint
        document.getElementById('hint').innerText = '';
    }
}



function finishLevel() {
    flashImage(); // Display the completion image
    gtag('event', 'finish_level', {
        'event_category': 'Game Actions',
        'event_label': `Level Completed - Difficulty: ${currentDifficulty}, Level: ${currentLevel}`
    });
}


const completionImages = [
    'images/image1.webp',
    'images/image2.webp',
    'images/image3.webp',
    'images/image4.webp',
    'images/image5.webp',
    'images/image6.webp',
    'images/image7.webp',
    'images/image8.webp',
    'images/image9.webp',
    'images/image10.webp',
    'images/image11.webp',
    'images/image12.webp',
    'images/image13.webp',
    'images/image14.webp',
    'images/image15.webp',
    'images/image16.webp',
    'images/image17.webp',
    'images/image18.webp',
    'images/image19.webp',
    'images/image20.webp',
    'images/image21.webp',
    'images/image22.webp',
    'images/image23.webp',
    'images/image24.webp',
    'images/image25.webp',
    'images/image26.webp',
    'images/image27.webp',
    'images/image28.webp',
    'images/image29.webp',
    'images/image30.webp',
    'images/image31.webp',
    'images/image32.webp',
    'images/image33.webp',
    'images/image34.webp',
    'images/image35.webp', 
];
// Shuffle the completionImages array once at the beginning
shuffleArray(completionImages);
// Variable to keep track of the current image index
let currentImageIndex = 0;

function flashImage() {
    setTimeout(() => {
        const gameContainer = document.getElementById('game-container');
        const titleElement = document.querySelector('.game-wrapper > h1');

        gameContainer.style.display = 'none';
        titleElement.style.color = 'black';

        const imageContainer = document.createElement('div');
        imageContainer.style.opacity = '0';
        imageContainer.style.transition = 'opacity 1s ease-in-out';
        imageContainer.style.position = 'absolute';
        imageContainer.style.zIndex = '1000';
        imageContainer.style.width = '80%';
        imageContainer.style.maxWidth = '600px';
        imageContainer.style.margin = 'auto';
        imageContainer.style.left = '0';
        imageContainer.style.right = '0';
        imageContainer.style.top = '50%';
        imageContainer.style.transform = 'translateY(-50%)';
        imageContainer.style.textAlign = 'center';
        imageContainer.style.borderRadius = '10px';
        document.body.appendChild(imageContainer);

        const completionMessage = document.createElement('p');
        completionMessage.innerText = `Well done! You passed Level ${currentLevel}.`;
        completionMessage.style.fontSize = '24px';
        completionMessage.style.fontWeight = 'bold';
        completionMessage.style.marginBottom = '10px';
        imageContainer.appendChild(completionMessage);

        const clickMessage = document.createElement('p');
        clickMessage.innerText = "Click anywhere to continue";
        clickMessage.style.fontSize = '16px';
        imageContainer.appendChild(clickMessage);

        const imageSrc = completionImages[currentImageIndex];
        const image = document.createElement('img');
        image.src = imageSrc;
        image.alt = 'Flashing Image';
        image.style.width = '100%';
        image.style.borderRadius = '10px';
        imageContainer.appendChild(image);

        setTimeout(() => imageContainer.style.opacity = '1', 0);

        currentImageIndex = (currentImageIndex + 1) % completionImages.length;

        // Event Listener to remove the image container on click and progress to the next level/difficulty
        imageContainer.addEventListener('click', () => {
            document.body.removeChild(imageContainer);
            gameContainer.style.display = '';
            titleElement.style.color = '';

            let nextLevel = parseInt(currentLevel) + 1;
            let difficulties = Object.keys(gameData);
            let currentDifficultyIndex = difficulties.indexOf(currentDifficulty);

            if (nextLevel > Object.keys(gameData[currentDifficulty]).length) {
                if (currentDifficultyIndex < difficulties.length - 1) {
                    let nextDifficulty = difficulties[currentDifficultyIndex + 1];
                    startLevel(nextDifficulty, "1"); // Start first level of the next difficulty
                    updateDropdowns(nextDifficulty, "1");
                } else {
                    updateDisplay('Congratulations! You have completed all levels and difficulties.');
                }
            } else {
                startLevel(currentDifficulty, String(nextLevel));
                updateDropdowns(currentDifficulty, String(nextLevel));
            }
        });
    }, 2000);
}

function updateDropdowns(newDifficulty, newLevel) {
    const difficultySelect = document.getElementById('difficulty-selector');
    const levelSelect = document.getElementById('level-select');
    difficultySelect.value = newDifficulty;
    levelSelect.value = newLevel;
}


function populateDifficulties() {
    const difficultySelect = document.getElementById('difficulty-selector');
    difficultySelect.innerHTML = ''; // Clear existing options

    Object.keys(gameData).forEach(difficulty => {
        const option = document.createElement('option');
        option.value = difficulty;
        option.textContent = difficulty;
        difficultySelect.appendChild(option);
    });
}

document.getElementById('instructions-button').addEventListener('click', function() {
    document.getElementById('instructions-container').style.display = 'block';
});

document.getElementById('close-instructions').addEventListener('click', function() {
    document.getElementById('instructions-container').style.display = 'none';
});

function playWordAudio(playIntro = true) {
    if (playIntro) {
        // Select a random intro audio file
        const introIndex = Math.floor(Math.random() * introAudios.length);
        const introAudioPath = `audio/intro_files/${introAudios[introIndex]}.mp3`;
        const introAudio = new Audio(introAudioPath);

        introAudio.onended = () => {
            // Play the word audio after the intro audio ends
            const currentWord = gameData[currentDifficulty][currentLevel][currentQuestionIndex].correct;
            const wordAudioPath = `audio/audio_files/${currentWord}.mp3`;
            const wordAudio = new Audio(wordAudioPath);
            wordAudio.play();
        };

        // Play the intro audio
        introAudio.play().catch(error => {
            console.error("Error playing intro audio:", error);
        });
    } else {
        // Play only the word audio
        const currentWord = gameData[currentDifficulty][currentLevel][currentQuestionIndex].correct;
        const wordAudioPath = `audio/audio_files/${currentWord}.mp3`;
        const wordAudio = new Audio(wordAudioPath);
        wordAudio.play();
    }
}

document.getElementById('play-audio').addEventListener('click', () => playWordAudio(false));

function createKeyboard(mode) {
    clearKeyboard();

    const keyboardLayout = ['qwertyuiop', 'asdfghjkl', 'zxcvbnm'];
    const currentWord = gameData[currentDifficulty][currentLevel][currentQuestionIndex].correct.toLowerCase();
    let lettersToInclude = getLettersForMode(currentWord, mode);

    const keyboardContainer = document.createElement('div');
    keyboardContainer.id = 'keyboard-container';
    gameContainer.appendChild(keyboardContainer);

    const colors = ['#007bff', '#17a2b8', '#fd7e14', '#6f42c1', '#20c997', '#FF7F50', '#FF00FF'];
    const randomColorIndex = Math.floor(Math.random() * colors.length);
    const buttonColor = colors[randomColorIndex];

    keyboardLayout.forEach(row => {
        const rowDiv = document.createElement('div');
        rowDiv.className = 'keyboard-row';
        row.split('').forEach(letter => {
            const keyButton = document.createElement('button');
            keyButton.className = 'keyboard-key';
            keyButton.textContent = letter;
            keyButton.style.backgroundColor = buttonColor;
            keyButton.style.color = 'white';
            if (!lettersToInclude.includes(letter) && mode !== 'Hard') {
                keyButton.style.visibility = 'hidden'; // Hide irrelevant keys in Easy and Medium modes
            }
            keyButton.addEventListener('click', () => handleKeyPress(keyButton, letter));
            rowDiv.appendChild(keyButton);
        });
        keyboardContainer.appendChild(rowDiv);
    });
}

function setupGameContainer() {
    const spelledWordElement = document.createElement('div');
    spelledWordElement.id = 'spelled-word';
    gameContainer.insertBefore(spelledWordElement, gameContainer.firstChild);

    // Initialize the placeholder for the spelled word
    updateSpelledWordPlaceholder();
}

function updateSpelledWordPlaceholder() {
    const currentQuestion = gameData[currentDifficulty][currentLevel][currentQuestionIndex];
    const placeholder = '_ '.repeat(currentQuestion.correct.length).trim();
    document.getElementById('spelled-word').textContent = placeholder;
}

function handleKeyPress(button, letter) {
    const currentQuestion = gameData[currentDifficulty][currentLevel][currentQuestionIndex];
    const spelledWordElement = document.getElementById('spelled-word');
    let currentSpelling = spelledWordElement.textContent.replace(/_/g, '').trim();

    letter = letter.toLowerCase(); // Ensure letter is lowercase for comparison

    if (currentQuestion.correct.toLowerCase().startsWith(currentSpelling + letter)) {
        currentSpelling += letter;
        spelledWordElement.textContent = currentSpelling + ' ' + '_'.repeat(currentQuestion.correct.length - currentSpelling.length);
        button.classList.add('flash-green');
        setTimeout(() => button.classList.remove('flash-green'), 500);

        // Clear the "Oops..." message if present
        clearMessage();

        if (currentSpelling.toLowerCase() === currentQuestion.correct.toLowerCase()) {
            handleCorrectSpelling();
        }
    } else {
        button.classList.add('flash-red');
        setTimeout(() => button.classList.remove('flash-red'), 500);
        mistakes++;
        updateDisplay('Oops, thats not right. Try again.');
    }
}

function checkSpelling() {
    const spelledWord = document.getElementById('spelled-word').textContent.replace(/\s+/g, '');
    const currentQuestion = gameData[currentDifficulty][currentLevel][currentQuestionIndex];

    console.log(`Checking spelling: ${spelledWord}, Correct answer: ${currentQuestion.correct}`);

    if (spelledWord.toLowerCase() === currentQuestion.correct.toLowerCase()) {
        handleCorrectSpelling();
    }
}

function handleCorrectSpelling() {
    gameContainer.classList.add('flash-green');
    setTimeout(() => gameContainer.classList.remove('flash-green'), 500);
    score++;
    updateDisplay('Correct!');
    setTimeout(clearMessage, 5000);
    currentQuestionIndex++;

    if (currentQuestionIndex >= gameData[currentDifficulty][currentLevel].length) {
        updateDisplay('Round ' + currentLevel + ' complete! Moving to next level...');
        finishLevel();
    } else {
        setTimeout(() => {
            // Create new word buttons for the next question
            createWordButtons(gameData[currentDifficulty][currentLevel][currentQuestionIndex].words);
            // Update the spelled word placeholder for the next question
            updateSpelledWordPlaceholder();
            // Recreate the keyboard for the new word
            createKeyboard(currentMode);
        }, 500);
    }
}


function flashWord(word) {
    const hintElement = document.getElementById('hint');
    const originalHint = hintElement.innerText;
    hintElement.innerText = word;
    setTimeout(() => {
        hintElement.innerText = originalHint;
    }, 2000); // Flash the word for 2 seconds
}

function getLettersForMode(word, mode) {
    let lettersToInclude = getUniqueLetters(word);
    if (mode === 'Medium') {
        addRandomLetters(lettersToInclude, 5);
    } else if (mode === 'Hard') {
        lettersToInclude = 'abcdefghijklmnopqrstuvwxyz'.split('');
    }
    return lettersToInclude;
}

function getUniqueLetters(word) {
    return Array.from(new Set(word.split('')));
}

function addRandomLetters(lettersArray, count) {
    const allLetters = 'abcdefghijklmnopqrstuvwxyz'.split('');
    while (count > 0) {
        let randomLetter = allLetters[Math.floor(Math.random() * allLetters.length)];
        if (!lettersArray.includes(randomLetter)) {
            lettersArray.push(randomLetter);
            count--;
        }
    }
}

document.getElementById('mode-select').addEventListener('change', () => {
    currentMode = modeSelect.value;
    createKeyboard(currentMode); // Update the keyboard based on the selected mode

    // Refresh the current question to apply the mode change immediately
    createWordButtons(gameData[currentDifficulty][currentLevel][currentQuestionIndex].words);
    updateSpelledWordPlaceholder(); // Refresh the spelled word placeholder
});

